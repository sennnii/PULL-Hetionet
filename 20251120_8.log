nohup python -u main_hetionet.py --hidden_dim 128 --lr 0.0005 --epochs 100 > 20251120_8.log 2>&1 &
nohup: ignoring input
사용 장치: cuda:0
전처리된 Hetionet 데이터 로드 중...
데이터 분할 중 (Train/Val/Test)...
  - Validation negative 샘플 생성 중...
  - Test negative 샘플 생성 중...

[데이터 로드 완료]
학습용 'treats' 엣지: 605
검증용 'treats' 엣지 (Pos): 150
검증용 'treats' 엣지 (Neg): 150
테스트용 'treats' 엣지 (Pos): 150
테스트용 'treats' 엣지 (Neg): 150
  [Model] Anatomy: Emb 402 -> Hidden 128
  [Model] Biological Process: Emb 11381 -> Hidden 128
  [Model] Cellular Component: Emb 1391 -> Hidden 128
  [Model] Compound: Feat 512 -> Hidden 128
  [Model] Disease: Emb 137 -> Hidden 128
  [Model] Gene: Emb 20945 -> Hidden 128
  [Model] Molecular Function: Emb 2884 -> Hidden 128
  [Model] Pathway: Emb 1822 -> Hidden 128
  [Model] Pharmacologic Class: Emb 345 -> Hidden 128
  [Model] Side Effect: Emb 5734 -> Hidden 128
  [Model] Symptom: Emb 438 -> Hidden 128

[PULL 모델 학습 시작]
Epoch: 01, Loss: 0.5719, Val AUC: 0.7213, Test AUC: 0.7195 (Patience: 0/20)
  - PULL: 새로운 positive 엣지(Expected Graph) 탐색 중...
  - PULL: 18개 엣지 추가 (Max Cap: 605, Min Prob: 1.0000)
Epoch: 02, Loss: 0.2606, Val AUC: 0.7244, Test AUC: 0.7354 (Patience: 0/20)
  - PULL: 새로운 positive 엣지(Expected Graph) 탐색 중...
  - PULL: 36개 엣지 추가 (Max Cap: 605, Min Prob: 0.9995)
Epoch: 03, Loss: 0.2148, Val AUC: 0.7286, Test AUC: 0.7428 (Patience: 0/20)
  - PULL: 새로운 positive 엣지(Expected Graph) 탐색 중...
  - PULL: 54개 엣지 추가 (Max Cap: 605, Min Prob: 0.9994)
Epoch: 04, Loss: 0.1776, Val AUC: 0.7235, Test AUC: 0.7471 (Patience: 1/20)
  - PULL: 새로운 positive 엣지(Expected Graph) 탐색 중...
  - PULL: 72개 엣지 추가 (Max Cap: 605, Min Prob: 0.9998)
Epoch: 05, Loss: 0.1442, Val AUC: 0.7307, Test AUC: 0.7496 (Patience: 0/20)
  - PULL: 새로운 positive 엣지(Expected Graph) 탐색 중...
  - PULL: 90개 엣지 추가 (Max Cap: 605, Min Prob: 0.9995)
Epoch: 06, Loss: 0.1149, Val AUC: 0.7277, Test AUC: 0.7525 (Patience: 1/20)
  - PULL: 새로운 positive 엣지(Expected Graph) 탐색 중...
  - PULL: 108개 엣지 추가 (Max Cap: 605, Min Prob: 0.9995)
Epoch: 07, Loss: 0.1008, Val AUC: 0.7279, Test AUC: 0.7439 (Patience: 2/20)
  - PULL: 새로운 positive 엣지(Expected Graph) 탐색 중...
  - PULL: 127개 엣지 추가 (Max Cap: 605, Min Prob: 0.9996)
Epoch: 08, Loss: 0.0944, Val AUC: 0.7257, Test AUC: 0.7530 (Patience: 3/20)
  - PULL: 새로운 positive 엣지(Expected Graph) 탐색 중...
  - PULL: 145개 엣지 추가 (Max Cap: 605, Min Prob: 0.9999)
Epoch: 09, Loss: 0.0839, Val AUC: 0.7343, Test AUC: 0.7420 (Patience: 0/20)
  - PULL: 새로운 positive 엣지(Expected Graph) 탐색 중...
  - PULL: 163개 엣지 추가 (Max Cap: 605, Min Prob: 0.9998)
Epoch: 10, Loss: 0.0750, Val AUC: 0.7384, Test AUC: 0.7494 (Patience: 0/20)
  - PULL: 새로운 positive 엣지(Expected Graph) 탐색 중...
  - PULL: 181개 엣지 추가 (Max Cap: 605, Min Prob: 0.9985)
Epoch: 11, Loss: 0.0704, Val AUC: 0.7376, Test AUC: 0.7443 (Patience: 1/20)
  - PULL: 새로운 positive 엣지(Expected Graph) 탐색 중...
  - PULL: 199개 엣지 추가 (Max Cap: 605, Min Prob: 0.9997)
Epoch: 12, Loss: 0.0659, Val AUC: 0.7404, Test AUC: 0.7464 (Patience: 0/20)
  - PULL: 새로운 positive 엣지(Expected Graph) 탐색 중...
  - PULL: 217개 엣지 추가 (Max Cap: 605, Min Prob: 0.9997)
Epoch: 13, Loss: 0.0668, Val AUC: 0.7420, Test AUC: 0.7483 (Patience: 0/20)
  - PULL: 새로운 positive 엣지(Expected Graph) 탐색 중...
  - PULL: 235개 엣지 추가 (Max Cap: 605, Min Prob: 0.9994)
Epoch: 14, Loss: 0.0641, Val AUC: 0.7400, Test AUC: 0.7536 (Patience: 1/20)
  - PULL: 새로운 positive 엣지(Expected Graph) 탐색 중...
  - PULL: 254개 엣지 추가 (Max Cap: 605, Min Prob: 0.9988)
Epoch: 15, Loss: 0.0670, Val AUC: 0.7361, Test AUC: 0.7512 (Patience: 2/20)
  - PULL: 새로운 positive 엣지(Expected Graph) 탐색 중...
  - PULL: 272개 엣지 추가 (Max Cap: 605, Min Prob: 0.9993)
Epoch: 16, Loss: 0.0632, Val AUC: 0.7329, Test AUC: 0.7408 (Patience: 3/20)
  - PULL: 새로운 positive 엣지(Expected Graph) 탐색 중...
  - PULL: 290개 엣지 추가 (Max Cap: 605, Min Prob: 0.9968)
Epoch: 17, Loss: 0.0594, Val AUC: 0.7301, Test AUC: 0.7426 (Patience: 4/20)
  - PULL: 새로운 positive 엣지(Expected Graph) 탐색 중...
  - PULL: 308개 엣지 추가 (Max Cap: 605, Min Prob: 0.9981)
Epoch: 18, Loss: 0.0608, Val AUC: 0.7288, Test AUC: 0.7399 (Patience: 5/20)
  - PULL: 새로운 positive 엣지(Expected Graph) 탐색 중...
  - PULL: 326개 엣지 추가 (Max Cap: 605, Min Prob: 0.9987)
Epoch: 19, Loss: 0.0596, Val AUC: 0.7266, Test AUC: 0.7444 (Patience: 6/20)
  - PULL: 새로운 positive 엣지(Expected Graph) 탐색 중...
  - PULL: 344개 엣지 추가 (Max Cap: 605, Min Prob: 0.9957)
Epoch: 20, Loss: 0.0590, Val AUC: 0.7178, Test AUC: 0.7529 (Patience: 7/20)
  - PULL: 새로운 positive 엣지(Expected Graph) 탐색 중...
  - PULL: 363개 엣지 추가 (Max Cap: 605, Min Prob: 0.9977)
Epoch: 21, Loss: 0.0634, Val AUC: 0.7261, Test AUC: 0.7470 (Patience: 8/20)
  - PULL: 새로운 positive 엣지(Expected Graph) 탐색 중...
  - PULL: 381개 엣지 추가 (Max Cap: 605, Min Prob: 0.9974)
Epoch: 22, Loss: 0.0550, Val AUC: 0.7243, Test AUC: 0.7471 (Patience: 9/20)
  - PULL: 새로운 positive 엣지(Expected Graph) 탐색 중...
  - PULL: 399개 엣지 추가 (Max Cap: 605, Min Prob: 0.9982)
Epoch: 23, Loss: 0.0554, Val AUC: 0.7256, Test AUC: 0.7468 (Patience: 10/20)
  - PULL: 새로운 positive 엣지(Expected Graph) 탐색 중...
  - PULL: 417개 엣지 추가 (Max Cap: 605, Min Prob: 0.9975)
Epoch: 24, Loss: 0.0536, Val AUC: 0.7254, Test AUC: 0.7480 (Patience: 11/20)
  - PULL: 새로운 positive 엣지(Expected Graph) 탐색 중...
  - PULL: 435개 엣지 추가 (Max Cap: 605, Min Prob: 0.9962)
Epoch: 25, Loss: 0.0527, Val AUC: 0.7276, Test AUC: 0.7430 (Patience: 12/20)
  - PULL: 새로운 positive 엣지(Expected Graph) 탐색 중...
  - PULL: 453개 엣지 추가 (Max Cap: 605, Min Prob: 0.9959)
Epoch: 26, Loss: 0.0513, Val AUC: 0.7294, Test AUC: 0.7512 (Patience: 13/20)
  - PULL: 새로운 positive 엣지(Expected Graph) 탐색 중...
  - PULL: 471개 엣지 추가 (Max Cap: 605, Min Prob: 0.9992)
Epoch: 27, Loss: 0.0494, Val AUC: 0.7207, Test AUC: 0.7515 (Patience: 14/20)
  - PULL: 새로운 positive 엣지(Expected Graph) 탐색 중...
  - PULL: 490개 엣지 추가 (Max Cap: 605, Min Prob: 0.9974)
Epoch: 28, Loss: 0.0487, Val AUC: 0.7182, Test AUC: 0.7493 (Patience: 15/20)
  - PULL: 새로운 positive 엣지(Expected Graph) 탐색 중...
  - PULL: 508개 엣지 추가 (Max Cap: 605, Min Prob: 0.9968)
Epoch: 29, Loss: 0.0507, Val AUC: 0.7200, Test AUC: 0.7536 (Patience: 16/20)
  - PULL: 새로운 positive 엣지(Expected Graph) 탐색 중...
  - PULL: 526개 엣지 추가 (Max Cap: 605, Min Prob: 0.9947)
Epoch: 30, Loss: 0.0507, Val AUC: 0.7224, Test AUC: 0.7562 (Patience: 17/20)
  - PULL: 새로운 positive 엣지(Expected Graph) 탐색 중...
  - PULL: 544개 엣지 추가 (Max Cap: 605, Min Prob: 0.9980)
Epoch: 31, Loss: 0.0456, Val AUC: 0.7213, Test AUC: 0.7629 (Patience: 18/20)
  - PULL: 새로운 positive 엣지(Expected Graph) 탐색 중...
  - PULL: 562개 엣지 추가 (Max Cap: 605, Min Prob: 0.9967)
Epoch: 32, Loss: 0.0495, Val AUC: 0.7292, Test AUC: 0.7592 (Patience: 19/20)
  - PULL: 새로운 positive 엣지(Expected Graph) 탐색 중...
  - PULL: 580개 엣지 추가 (Max Cap: 605, Min Prob: 0.9958)
Early Stopping: 20 Epoch 동안 성능 향상이 없어 조기 종료합니다.

[학습 완료]
Best Epoch: 13, Val AUC: 0.7420, Best Test AUC: 0.7483
총 학습 시간: 185.56s

[약물 재창출 후보 분석 시작]
[디버깅] Raw scores (마스킹 전):
  - 최소: -67.4040, 최대: 11.0696

--- 새로운 약물 재창출 후보 Top 20 (Correction Loss Applied) ---
01. [약물] Methylprednisolone -> [질병] psoriasis (확률: 0.9999)
02. [약물] Pamidronate -> [질병] lymphatic system cancer (확률: 0.9999)
03. [약물] Methazolamide -> [질병] migraine (확률: 0.9999)
04. [약물] Rifampicin -> [질병] malaria (확률: 0.9999)
05. [약물] Acetazolamide -> [질병] migraine (확률: 0.9999)
06. [약물] Risedronate -> [질병] lymphatic system cancer (확률: 0.9999)
07. [약물] Alendronate -> [질병] lymphatic system cancer (확률: 0.9998)
08. [약물] Indomethacin -> [질병] primary biliary cirrhosis (확률: 0.9998)
09. [약물] Naproxen -> [질병] primary biliary cirrhosis (확률: 0.9998)
10. [약물] Triamcinolone -> [질병] systemic scleroderma (확률: 0.9998)
11. [약물] Triamcinolone -> [질병] Crohn's disease (확률: 0.9998)
12. [약물] Topiramate -> [질병] glaucoma (확률: 0.9998)
13. [약물] Bupropion -> [질병] epilepsy syndrome (확률: 0.9998)
14. [약물] Methimazole -> [질병] malaria (확률: 0.9998)
15. [약물] Colchicine -> [질병] nephrolithiasis (확률: 0.9998)
16. [약물] Telbivudine -> [질병] malaria (확률: 0.9998)
17. [약물] Epirubicin -> [질병] lung cancer (확률: 0.9997)
18. [약물] Sibutramine -> [질병] epilepsy syndrome (확률: 0.9997)
19. [약물] Trimethadione -> [질병] obesity (확률: 0.9997)
20. [약물] Felbamate -> [질병] obesity (확률: 0.9997)
